#!/usr/bin/env ruby

require_relative "../config/env"
require "drawing_visitor"
require "engine"
require "fetcher"
require "gosu_box_renderer"
require "gosu_text_renderer"
require "gui_window"
require "parser"
require "root_node_dimensions_setter"

browser = GuiWindow.new(
  Engine.new(
    fetcher: Fetcher.new,
    drawing_visitor: DrawingVisitor.new(
      box_renderer: GosuBoxRenderer.new,
      text_renderer: GosuTextRenderer.new,
    ),
    layout_visitor_factory: RootNodeDimensionsSetter.method(:new),
    parser: Parser.new,
  )
)

uri = ARGV[0]

if uri
  browser.address = uri
  browser.go
end

browser.show
